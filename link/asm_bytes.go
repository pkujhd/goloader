package link

// arm/arm64
var (
	armReplaceCallCode = []byte{0x04, 0xF0, 0x1F, 0xE5} //LDR PC, [PC, #-4]
	// register X27 reserved for liblink. see:^src/cmd/objfile/obj/arm64/a.out.go
	arm64ReplaceCALLCode = []byte{
		0x5B, 0x00, 0x00, 0x58, // LDR X27 [PC+8] - read 64 bit address from PC+8 into X27
		0x60, 0x03, 0x1F, 0xD6, // BR  X27 - jump to address in X27
	}
	arm64BCode   = []byte{0x00, 0x00, 0x00, 0x14} // B [PC+0x0]
	arm64LDRCode = []byte{0x00, 0x00, 0x40, 0xF9} // LDR XX [XX]
	arm64NOPCode = []byte{0x1f, 0x20, 0x03, 0xd5} // NOP
)

// x86/amd64

const (
	x86amd64MOVCode byte = 0x8B
	x86amd64NOPCode byte = 0x90
)

var (
	x86amd64JMPLCode        = []byte{0xFF, 0x25, 0x00, 0x00, 0x00, 0x00} // JMPL *ADDRESS
	x86amd64JMPNCode        = []byte{0xE9, 0x00, 0x00, 0x00, 0x00}       // JMP (PCREL offset)
	x86amd64CALLCode        = []byte{0xFF, 0x15, 0x00, 0x00, 0x00, 0x00} // CALL *(rel)rip
	x86amd64ReplaceCALLCode = []byte{
		//CALL *(rel)rip
		0xFF, 0x15, 0x00, 0x00, 0x00, 0x00,
		//JMP (PCREL offset)
		0xE9, 0x00, 0x00, 0x00, 0x00,
	}

	x86amd64ReplaceCMPCode = []byte{
		// PUSH RAX
		0x50,
		// MOVABS RAX, imm64 (64 bit)
		0x48, 0xB8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		// CMPL [RAX] x(8bits)
		0x48, 0x83, 0x38, 0x00,
		// POP RAX
		0x58,
		// JMP (PCREL offset)
		0xE9, 0x00, 0x00, 0x00, 0x00,
	}
	
	x86amd64ReplaceMOVCode = []byte{
		// MOVABS RxX x (64 bit)
		0x48, 0xB8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		// MOV RxX [RxX]
		0x48, 0x8B, 0x00,
		// JMP (PCREL offset)
		0xE9, 0x00, 0x00, 0x00, 0x00,
	}
)
